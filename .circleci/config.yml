# This file was generated by the excavator check 'excavator/manage-circleci' as specified in .circleci/template.sh.
# To request a modification to the general template, file an issue on Excavator.
# To manually manage the CircleCI configuration for this project, remove the .circleci/template.sh file.

version: 2.1

orbs:
  go: palantir/go@0.0.29
  godel: palantir/godel@0.0.29

homepath: &homepath
  homepath: /home/circleci

gopath: &gopath
  gopath: /home/circleci/go

working_directory: &working_directory
    working_directory: /home/circleci/go/src/github.com/palantir/log4j-sniffer

executors:
  circleci-go:
    docker:
      - image: cimg/go:1.18-browsers
    <<: *working_directory

all-tags-filter: &all-tags-filter
  filters:
    tags:
      only: /.*/

jobs:
  circle-all:
    docker: [{ image: 'busybox:1.36.1@sha256:6d9ac9237a84afe1516540f40a0fafdc86859b2141954b4d643af7066d598b74' }]
    resource_class: small
    steps:
      - run: {command: echo "All required jobs finished successfully"}

workflows:
  version: 2
  verify-test-dist-publish:
    jobs:
      - godel/verify:
          name: verify
          executor: circleci-go
          <<: *homepath
          <<: *gopath
          <<: *all-tags-filter
      - godel/test:
          name: test
          executor: circleci-go
          <<: *homepath
          <<: *gopath
          <<: *all-tags-filter
      - godel/dist:
          name: dist
          executor: circleci-go
          <<: *homepath
          <<: *gopath
          <<: *all-tags-filter
      - circle-all:
          requires: [verify, test, dist]
          <<: *all-tags-filter
